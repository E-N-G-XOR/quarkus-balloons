{"version":3,"file":"achievement.component.js","sourceRoot":"","sources":["achievement.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, Input, OnChanges, SimpleChange, ElementRef } from '@angular/core';\nimport { GameService } from '../service/game.service';\n\n@Component({\n  moduleId: module.id,\n  selector: 'app-achievement',\n  templateUrl: 'achievement.component.html',\n  styleUrls: ['achievement.component.css']\n})\nexport class AchievementComponent {\n  element: ElementRef;\n  achievements: Array<any> = [];\n\n  constructor(private _element: ElementRef, private gameService: GameService) {\n    this.element = _element;\n\n    this.achievementChangeHandler = this.achievementChangeHandler.bind(this);\n    this.animationEndHandler = this.animationEndHandler.bind(this);\n    this.transitionEndHandler = this.transitionEndHandler.bind(this);\n\n    this.gameService.achievementsChange.subscribe(this.achievementChangeHandler);\n    this.element.nativeElement.addEventListener(this.whichAnimationEvent(), this.animationEndHandler);\n    this.element.nativeElement.addEventListener(this.whichTransitionEvent(), this.transitionEndHandler);\n  }\n\n  achievementChangeHandler(achievement) {\n    this.achievements.push(achievement);\n    this.showAchievement();\n  }\n\n  showAchievement() {\n    console.log('showing achievement');\n    this.element.nativeElement.classList.add('visible');\n  }\n\n  animationEndHandler(evt) {\n    console.log('in animation handler');\n    if (evt.target.classList.contains('visible')) {\n      setTimeout(() => {\n        evt.target.classList.remove('visible');\n        console.log('animation handler timeout done!');\n      }, 3000);\n    }\n  }\n\n  transitionEndHandler(evt) {\n    if (evt.target.classList.contains('visible')) {\n      return;\n    }\n    \n    console.log('removing achievement');\n    this.achievements.shift();\n\n    if (this.achievements.length > 0) {\n      console.log('showing another achievement');\n      this.showAchievement();\n    }\n  }\n\n  whichTransitionEvent() {\n    var t;\n    var el = document.createElement('fakeelement');\n    var transitions = {\n      'transition':'transitionend',\n      'OTransition':'oTransitionEnd',\n      'MozTransition':'transitionend',\n      'WebkitTransition':'webkitTransitionEnd'\n    }\n\n    for (t in transitions){\n      if ( el.style[t] !== undefined ) {\n        console.log('transition event: ' + transitions[t]);\n        return transitions[t];\n      }\n    }\n  }\n\n  whichAnimationEvent() {\n    var t;\n    var el = document.createElement('fakeelement');\n    var transitions = {\n      'animation':'animationend',\n      'OAnimation':'oAnimationEnd',\n      'MozAnimation':'animationend',\n      'WebkitAnimation':'webkitAnimationEnd'\n    }\n\n    for (t in transitions){\n      if ( el.style[t] !== undefined ) {\n        console.log('animation event: ' + transitions[t]);\n        return transitions[t];\n      }\n    }\n  }\n\n}\n"]}